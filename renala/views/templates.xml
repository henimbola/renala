<odoo>
    <data>
        <!-- Inherit quotation report (from module sale) -->
        <template id = "report_quotation_inherit_renala" inherit_id="account.report_invoice_document">
            
            <xpath expr = "//div[@class='row mt32 mb32']" position="attributes">
                <attribute name="t-att-style">"font-size: 16px;"</attribute>
            </xpath>

            <xpath expr = "//div[@class='col-xs-2' and @t-if='o.date_invoice']" position="replace">
                <div class="col-xs-4" t-if="o.date_invoice">
                    <strong>Date de la facture:</strong>
                    <span t-field="o.date_invoice"/>
                </div>
            </xpath>

            <xpath expr = "//p[@t-if='o.payment_term_id']" position="replace">
            </xpath>

            <xpath expr = "//div[@class='row mt32 mb32']" position="after">
                <p t-if="o.payment_term_id">
                    <span t-field="o.payment_term_id.note"/>
                </p>
            </xpath>

            <xpath expr = "//p[@t-if='o.comment']" position="replace">
            </xpath>
            
            <xpath expr = "//p[@t-if='o.payment_term_id']" position="after">
                <p>Mode de paiement : <span t-field="o.company_id.payment_method"/></p>
                <p t-if="o.comment">
                    <!--<strong>Comment : </strong>-->
                    <span t-field="o.comment"/>
                </p>
            </xpath>
            
            <xpath expr = "//p[@t-if='o.comment']" position="after">
            <p>
                
                <span t-if="o.partner_id.bank_ids.bank_name">
                    <strong>BANK : </strong>
                    <span t-field="o.partner_id.bank_ids.bank_name"/><br/>
                </span>
                
                <span t-if="'o.company_id.street' or 'o.company_id.street2' or 'o.company_id.city' or 'o.company_id.zip' or 'o.company_id.country_id'">
                    <strong>ADRESSE : </strong>
                    <span t-if="o.company_id.street"><span t-field="o.company_id.street"/>, </span>
                    <span t-if="o.company_id.street2"><span t-field="o.company_id.street2"/>, </span>
                    <span t-if="o.company_id.city"><span t-field="o.company_id.city"/>, </span>
                    <span t-if="o.company_id.zip"><span t-field="o.company_id.zip"/>, </span>
                    <span t-if="o.company_id.country_id"><span t-field="o.company_id.country_id"/></span><br/>
                </span>
                
                <span t-if="o.partner_id.bank_ids.acc_number">
                    <strong>IBAN : </strong>
                    <span t-field="o.partner_id.bank_ids.acc_number"/><br/>
                </span>
                
                <span t-if="o.partner_id.bank_ids.bank_bic">
                    <strong>BIC : </strong>
                    <span t-field="o.partner_id.bank_ids.bank_bic"/><br/>
                </span>

            </p>
            </xpath>

            <xpath expr = "//tr[@class='border-black']/td/strong[text()='Total']" position="replace">
                <strong>Total TTC</strong>
            </xpath>
            
            <xpath expr = "//t[@t-foreach='o._get_tax_amount_by_group()']" position="before">
                    <!--<tr t-if="not o.invoice_line_ids.invoice_line_tax_ids">-->
                    <t t-set="tax_exist" t-value="False"/>
                    <t t-foreach="o.invoice_line_ids" t-as="invoice_line">
                        <t t-if="invoice_line.invoice_line_tax_ids">
                            <t t-set="tax_exist" t-value="True"/>    
                        </t>
                    </t>
                    <tr t-if="not tax_exist">
                        <td><span>TVA 20%</span></td>
                            
                        <td class="text-right">
                        
                        </td>
                    </tr>
            </xpath>

            <!--<xpath expr = "//tbody[@class='invoice_tbody']/tr/td[6]/span" position="before">
                <span t-if="not o.invoice_line_ids.invoice_line_tax_ids">TVA 20%</span>
                <span t-if="o.invoice_line_ids.invoice_line_tax_ids">TVA 20% ,</span>
            </xpath>

            <xpath expr = "//t[@t-foreach='o._get_tax_amount_by_group()']" position="before">
                    <tr>
                        <td><span>TVA 20%</span></td>
                        <td class="text-right">
                            <span t-esc="(o.amount_untaxed * o.tva20)" t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: o.currency_id}"/>
                        </td>
                    </tr>
            </xpath>

            <xpath expr = "//span[@t-field='o.amount_total']" position="replace">
                <span t-if="not o.invoice_line_ids.invoice_line_tax_ids">                
                    <span t-esc="o.amount_total + (o.amount_untaxed * o.tva20)" t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: o.currency_id}"/>
                </span>
                <span t-if="o.invoice_line_ids.invoice_line_tax_ids">                
                    <span t-field="o.amount_total" t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: o.currency_id}"/>
                </span>
            </xpath>-->
            
        </template>
        <!-- Change the size of the company logo, company address, footer-->
        <template id="report_company_logo_resize" inherit_id="report.external_layout_header">
            <xpath expr="//div[@class='col-xs-3']//img" position="replace">
                <img t-if="company.logo" t-att-src="'data:image/png;base64,%s' % company.logo" style="height: 100px; width: 200px"/>
            </xpath>
            <xpath expr="//div[@name='company_address']//span" position="replace">
                <span t-field="company.partner_id" t-field-options="{&quot;widget&quot;: &quot;contact&quot;, &quot;fields&quot;: [&quot;address&quot;, &quot;name&quot;], &quot;no_marker&quot;: true}" style="border-bottom: 1px solid black; display:inline-block; font-size:19px"/>
            </xpath>
        </template>
        <template id="report_footer_resize" inherit_id="report.external_layout_footer">
            <xpath expr="//t[@t-if='company.custom_footer']" position="attributes">
                <attribute name="t-att-style">"font-size: 6pt;"</attribute>
            </xpath>
            <xpath expr="//ul[@t-if='not company.custom_footer' and @class='list-inline']" position="replace">
                
                <t t-set="o" t-value="o.with_context({'lang':o.partner_id.lang})"/>
                    <span style="font-size: 6pt">
                        <span t-if="o.company_id"><span t-field="o.company_id"/> - CAPITAL : </span>
                        <span t-if="o.company_id.capital"><span t-field="o.company_id.capital"/> - </span>

                        <span t-if="o.company_id.street"><span t-field="o.company_id.street"/>, </span>
                        <span t-if="o.company_id.street2"><span t-field="o.company_id.street2"/>, </span>
                        <span t-if="o.company_id.city"><span t-field="o.company_id.city"/>, </span>
                        <span t-if="o.company_id.zip"><span t-field="o.company_id.zip"/>, </span>
                        <span t-if="o.company_id.country_id"><span t-field="o.company_id.country_id"/></span><br/>

                        <span t-if = "o.partner_id.partner_origin == 'locale'">NIF : <span t-field="o.partner_id.nif"/> - </span>
                        <span t-if = "o.partner_id.partner_origin == 'locale'">STAT : <span t-field="o.partner_id.nstat"/> - </span>
                        <span t-if = "o.partner_id.partner_origin == 'locale'">RCS : <span t-field="o.partner_id.rcs"/></span>
                    </span>
            </xpath>
            
        </template>
    </data>
</odoo>